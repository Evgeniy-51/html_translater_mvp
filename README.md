# HTML Lines Translator

Приложение для перевода HTML файлов с английского на русский язык с использованием ChatGPT.

## Особенности

- **Перевод span элементов** - переводит только текстовое содержимое в `<span>` тегах
- **Сохранение структуры** - HTML структура, атрибуты и теги остаются неизменными
- **Объединение параграфов** - автоматически объединяет разорванные span элементы
- **Прогресс и восстановление** - сохраняет прогресс и может продолжить с места остановки
- **Тестовый режим** - режим для разработки без реальных API вызовов
- **GUI интерфейс** - графический выбор файлов
- **Поддержка прокси** - работа через SOCKS5 прокси
- **Отслеживание токенов** - статистика использования API

## Структура проекта

```
html_lines_translator/
├── src/
│   ├── core/           # Основная логика
│   │   ├── translator.py
│   │   ├── translator_test.py
│   │   └── progress_manager.py
│   ├── parsers/        # Парсинг HTML
│   │   ├── html_parser.py
│   │   └── span_merger.py
│   ├── gui/            # Графический интерфейс
│   │   └── file_selector.py
│   ├── prompts/        # Управление промптами
│   │   └── prompt_template.py
│   └── utils/          # Вспомогательные скрипты
│       └── reset_progress.py
├── config.py           # Настройки приложения
├── main.py             # Точка входа
├── .env                # Переменные окружения
└── CONTENT/            # Входные и выходные файлы
```

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd html_lines_translator
```

2. Создайте виртуальное окружение и установите зависимости:
```bash
uv sync
```

3. Настройте переменные окружения в файле `.env`:
```env
OPENAI_API_KEY=your_api_key
PROXY_URL=socks5://proxy_host:port
PROXY_LOGIN=proxy_username
PROXY_PASSWORD=proxy_password
```

4. Настройте параметры в `config.py`:
```python
MODE = "work"  # "test" или "work"
INPUT_LANGUAGE = "english"
TARGET_LANGUAGE = "russian"
OPENAI_MODEL = "gpt-4o-mini"
```

## Использование

### GUI режим (рекомендуется)
```bash
uv run python main.py
```

### Командная строка
```bash
# Базовое использование
uv run python main.py CONTENT/input.html

# С указанием выходного файла
uv run python main.py CONTENT/input.html output.html
```

### Сброс прогресса
```bash
uv run python src/utils/reset_progress.py
```

## Режимы работы

### Тестовый режим (`MODE = "test"`)
- Имитирует перевод без реальных API вызовов
- Добавляет метку `[ПЕРЕВЕДЕНО]` к span элементам
- Полезен для разработки и тестирования

### Рабочий режим (`MODE = "work"`)
- Использует реальный OpenAI API
- Показывает статистику токенов
- Требует настройки API ключа и прокси

## Конфигурация

### Языки
Поддерживаемые языки в `config.py`:
- `english`, `russian`, `chinese`, `german`, `spanish`, `french`, `italian`, `japanese`, `korean`

### Модели OpenAI
Доступные модели с примерными ценами:
- `gpt-5-mini` - $0.25/$0.025/$2.00
- `gpt-5-nano` - $0.05/$0.005/$0.40
- `gpt-4o-mini` - $0.15/$0.075/$0.60 (рекомендуется)

## Особенности работы

### Объединение параграфов
Приложение автоматически объединяет span элементы, которые были разорваны при конвертации PDF:
- Если span не заканчивается знаками препинания (`.`, `!`, `?`, `..`)
- И следующий span не начинается с заглавной буквы
- То элементы объединяются в один

### Сохранение прогресса
- Прогресс сохраняется в `CONTENT/progress.json`
- При прерывании можно продолжить с последней успешно переведенной строки
- Используйте `reset_progress.py` для сброса

## Разработка

### Добавление новых функций
1. Создайте модуль в соответствующей директории `src/`
2. Обновите импорты в `main.py`
3. Протестируйте в тестовом режиме
4. Закоммитьте изменения

### Структура модулей
- **core/** - основная бизнес-логика
- **parsers/** - парсинг и обработка данных
- **gui/** - пользовательский интерфейс
- **prompts/** - управление промптами для LLM
- **utils/** - вспомогательные утилиты

## Лицензия

MIT License
